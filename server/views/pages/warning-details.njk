{% extends "../partials/layout.njk" %}

{% set pageTitle = applicationName + " - " + breachNotice.breachNoticeTypeDescription + " Details" %}
{% set mainClasses = "app-container govuk-body" %}

{% block content %}

 {% from "moj/components/side-navigation/macro.njk" import mojSideNavigation %}
 {% from "govuk/components/radios/macro.njk" import govukRadios %}
 {% from "govuk/components/select/macro.njk" import govukSelect %}
 {% from "moj/components/button-menu/macro.njk" import mojButtonMenu %}
 {% from "moj/components/date-picker/macro.njk" import mojDatePicker %}
 {% from "govuk/components/table/macro.njk" import govukTable %}
 {% from "govuk/components/input/macro.njk" import govukInput %}
 {% from "govuk/components/checkboxes/macro.njk" import govukCheckboxes %}
 {% from "govuk/components/details/macro.njk" import govukDetails %}
 {% from "govuk/components/table/macro.njk" import govukTable %}

 <form method="post">
  {% set errorList =[
   { text: errorMessages.responseRequiredByDate.text, href: "#date-of-letter" } if errorMessages.dateOfLetter else None,
   { text: errorMessages.pdfRenderError.text } if errorMessages.pdfRenderError else None
  ] | reject("undefined") %}

  {% if errorMessages | length > 0 %}
   {% from "govuk/components/error-summary/macro.njk" import govukErrorSummary %}
   {{ govukErrorSummary({ titleText: "There is a problem", errorList: errorList }) }}
  {% endif %}
  <input type="hidden" name="_csrf" value="{{ csrfToken }}">

  <div class="govuk-grid-row">
   <div class="govuk-grid-column-one-third">
    {% include "pages/side-nav.njk" %}
   </div>
   <div class="govuk-grid-column-two-thirds">
    <h1 class="govuk-heading-x1">{{ applicationName + " - " + breachNotice.breachNoticeTypeDescription + " Details" }}</h1>
    <h1 class="govuk-fieldset__legend--m">
     Condition being enforced
    </h1>
    2 occasions during a 12-month period
    <br/><br/>

    <div class="govuk-form-group">
     <fieldset class="govuk-fieldset" aria-describedby="signIn-hint">
      <legend class="govuk-fieldset__legend govuk-fieldset__legend--m">
       <h1 class="govuk-fieldset__heading">
        Failures recorded on this order
       </h1>
      </legend>
      <div id="signIn-hint" class="govuk-hint">
      </div>
      <div class="govuk-radios" data-module="govuk-radios">
       {% for failure in enforceableContactRadioButtonList %}
        <div class="govuk-radios__item">
         <input class="govuk-radios__input"
                id="contact-{{ failure.value }}"
                name="failureRecordedContact"
                type="radio"
                value="{{ failure.value }}"
                aria-describedby="enforceablecontact-item-hint"
                {% if failure.checked %}checked{% endif %}>

         <label class="govuk-label govuk-radios__label" for="contact-{{ failure.value }}">
          {{ failure.text }}
         </label>
         <div id="enforceablecontact-item-hint" class="govuk-hint govuk-radios__hint">
          {{ govukDetails({
           summaryText: "View requirement notes",
           text: failure.notes
          }) }}
         </div>
        </div>
       {% else %}
        <li>There are no failures recorded to display</li>
       {% endfor %}
      </div>
     </fieldset>
    </div>

    {{ govukCheckboxes({
     name: "failuresBeingEnforcedRequirements",
     fieldset: {
      legend: {
       text: "Select the Failures being enforced",
       isPageHeading: false,
       classes: "govuk-fieldset__legend--m"
      }
     },
     hint: {
      text: "Select all that apply"
     },
     items: requirementsList
    }) }}

    {{ mojDatePicker({
     id: "responseRequiredByDate",
     name: "responseRequiredByDate",
     value: warningDetailsResponseRequiredDate,
     label: {
      text: "Response Required By",
      classes: "govuk-fieldset__legend--m"
     },
     hint: {
      text: "For example, 17/5/2024."
     },
     errorMessage: {
      text: errorMessages.responseRequiredByDate.text
     } if errorMessages.responseRequiredByDate.text
    }) }}

    {{ mojButtonMenu({
     items: [{
      text: "Continue",
      preventDoubleClick: "true",
      type: "submit"
     }, {
      text: "Refresh from Delius",
      href: "#",
      classes: "govuk-button--secondary",
      preventDoubleClick: "true"
     }, {
      text: "Save Progress and Close",
      href: "/warning-type/"+breachNotice.id,
      classes: "govuk-button--secondary",
      preventDoubleClick: "true"
     }]
    }) }}

   </div>
  </div>
 </form>
{% endblock %}